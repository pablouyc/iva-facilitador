@page
@model IvaFacilitador.Areas.Payroll.Pages.PlanillaTotal.IndexModel
@{
    ViewData["Title"] = "Planilla total";
    ViewData["PayrollSection"] = "Planilla total";
}
<partial name="~/Areas/Payroll/Components/_Topbar.cshtml" />

<div class="container-fluid">
  <div class="row mb-3">
    <div class="col-auto">
      <label for="pt-from" class="form-label">Desde</label>
      <input id="pt-from" type="date" class="form-control" />
    </div>
    <div class="col-auto">
      <label for="pt-to" class="form-label">Hasta</label>
      <input id="pt-to" type="date" class="form-control" />
    </div>
    <div class="col-auto align-self-end">
      <button id="pt-apply" class="btn btn-primary">Aplicar</button>
    </div>
  </div>

  <div class="card">
    <div class="card-body">
      <div class="table-responsive">
        <table class="table table-sm align-middle">
          <thead>
            <tr>
              <th>Empresa</th>
              <th>Colaborador</th>
              <th>Identificación</th>
              <th>Cargo</th>
              <th>Salario mensual</th>
              <th>Salario período</th>
              <th>Extras</th>
              <th>Total ingreso</th>
              <th>Deducciones</th>
              <th>Neto</th>
            </tr>
          </thead>
          <tbody id="pt-body"></tbody>
        </table>
      </div>
    </div>
  </div>
</div>

@section Scripts{
<script>
(function(){
  const fmt = n => new Intl.NumberFormat('es-CR',{style:'currency',currency:'CRC',minimumFractionDigits:2}).format(n||0);

  // Mock de datos (puedes sustituir por API real luego)
  function mockData(){
    return [
      {empresa:"Empresa A (demo)", colab:"Ana Gómez", id:"1-1111-1111", cargo:"Contadora", salario:650000, periodo:325000, extras:25000, ded:18000},
      {empresa:"Empresa B (demo)", colab:"Luis Pérez", id:"2-2222-2222", cargo:"Operario",  salario:420000, periodo:210000, extras:12000, ded: 9000},
    ].map(x => ({...x, ingreso:(x.periodo + x.extras), neto:(x.periodo + x.extras - x.ded)}));
  }

  function render(rows){
    const tb = document.getElementById('pt-body');
    if(!tb) return;
    tb.innerHTML = rows.map(r => `
      <tr>
        <td>${r.empresa}</td>
        <td>${r.colab}</td>
        <td>${r.id}</td>
        <td>${r.cargo}</td>
        <td>${fmt(r.salario)}</td>
        <td>${fmt(r.periodo)}</td>
        <td><span class="text-primary" title="Detalle (mock)">${fmt(r.extras)}</span></td>
        <td>${fmt(r.ingreso)}</td>
        <td><span class="text-danger" title="Detalle (mock)">${fmt(r.ded)}</span></td>
        <td>${fmt(r.neto)}</td>
      </tr>`).join('');
  }

  document.getElementById('pt-apply')?.addEventListener('click', ()=> render(mockData()));
  // Carga inicial
  render(mockData());
})();
</script>
}
