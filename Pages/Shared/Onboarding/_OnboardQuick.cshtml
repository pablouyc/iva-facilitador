@* Overlay para parametrizar r√°pidamente la empresa *@
<div id="onb-overlay" class="onb-overlay" style="display:none;">
  <div class="onb-modal card shadow">
    <div class="card-header">
      <strong>Parametrizar empresa</strong>
    </div>
    <div class="card-body">
      <form method="post" asp-page="/Onboarding/Publish" id="onb-form">
        <div class="mb-3">
          <label class="form-label">Empresa</label>
          <input type="text" id="onb-company" class="form-control" readonly />
        </div>
        <input type="hidden" name="RealmId" id="onb-realm" />
          <div class="d-flex gap-2 justify-content-end">
            <a id="onb-configure" class="btn btn-secondary" href="#">Configurar ahora</a>
            <button type="submit" class="btn btn-primary">Listo</button>
          </div>
        </form>
      </div>
    </div>
  </div>

<script>
(function(){
  function getCookie(n){
    const m = document.cookie.match(new RegExp('(?:^|; )' + n.replace(/([.$?*|{}()\\[\\]\\\\\/\\+^])/g,'\\$1') + '=([^;]*)'));
    return m ? decodeURIComponent(m[1]) : null;
  }
  var c = getCookie('onb_company');
    if(c){
      var map = {};
      c.split('|').forEach(function(p){
        var i = p.indexOf('=');
        if(i > 0){
          var key = p.substring(0,i);
          var val = p.substring(i+1);
          map[key] = decodeURIComponent(val);
        }
      });
      if(map['company']) document.getElementById('onb-company').value = map['company'];
      if(map['realm']){
        document.getElementById('onb-realm').value = map['realm'];
        document.getElementById('onb-configure').href = '/Onboarding/Tariffs?realmId=' + encodeURIComponent(map['realm']);
      }
      document.getElementById('onb-overlay').style.display = 'flex';
      document.cookie = 'onb_company=; Max-Age=0; path=/';
    }
  })();
</script>
